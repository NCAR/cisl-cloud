
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Python Examples &#8212; CISL Cloud Pilot</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-pythia-theme.min.css?v=e502140d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css?v=bc89f96c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-7W0SHCDV52"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-7W0SHCDV52');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-7W0SHCDV52');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'how-to/Stratus/stratus-cmd';</script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="13 May 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>

  
  <div class="pst-scroll-pixel-helper"></div>
    <header class="bd-header navbar navbar-dark navbar-expand-lg bg-dark fixed-top bd-navbar shadow" id="navbar-main">
<div class="bd-header__inner bd-page-width">
  <button class="sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

   

<a class="navbar-brand logo" href="https://ncar.ucar.edu/">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/NSF-NCAR.png" class="logo__image only-light" alt="CISL Cloud Pilot - Home"/>
    <script>document.write(`<img src="../../_static/NSF-NCAR.png" class="logo__image only-dark" alt="CISL Cloud Pilot - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><ul id="navbar-main-elements" class="navbar-nav">

       
        
            
        
        <li class="nav-item">
            <a class="nav-link nav-internal" href="https://ncar-hpc-docs.readthedocs.io/en/latest/compute-systems/cirrus/">CIRRUS Docs</a>
        </li>    
    
    
       
        
            
        
        <li class="nav-item">
            <a class="nav-link nav-internal" href="https://www2.cisl.ucar.edu/">CISL Home</a>
        </li>    
    
    

</ul></div>
      
    </div>
    
    
  </div>
  
  

  
    <button class="sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
        
        
        
          
        
        <div class="bd-sidebar-primary bd-sidebar">
          

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item"><ul id="navbar-main-elements" class="navbar-nav">

       
        
            
        
        <li class="nav-item">
            <a class="nav-link nav-internal" href="https://ncar-hpc-docs.readthedocs.io/en/latest/compute-systems/cirrus/">CIRRUS Docs</a>
        </li>    
    
    
       
        
            
        
        <li class="nav-item">
            <a class="nav-link nav-internal" href="https://www2.cisl.ucar.edu/">CISL Home</a>
        </li>    
    
    

</ul></div>
          
        
      </div>
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


        </div>

        
        <main id="main-content" class="bd-main" role="main">
          

            <div class="bd-content">

              <div class="bd-article-container">

                
                  
                  
<div id="searchbox"></div>
                  <article class="bd-article">
                    
  <section class="tex2jax_ignore mathjax_ignore" id="python-examples">
<h1>Python Examples<a class="headerlink" href="#python-examples" title="Link to this heading">#</a></h1>
<p>The following are some example Python functions for interacting with Stratus</p>
<section id="isd-s3">
<h2>isd_s3<a class="headerlink" href="#isd-s3" title="Link to this heading">#</a></h2>
<p>The NCAR ISD S3 Object Storage utility is a python module that was designed and developed by the Information Systems Division (ISD) within CISL at NCAR.</p>
<p>Source Code: <a class="github reference external" href="https://github.com/NCAR/isd-s3">NCAR/isd-s3</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only a few high level examples are outlined in this document. There are more functions available under the Session class that can be found at this <a class="reference external" href="https://github.com/NCAR/isd-s3/blob/main/isd_s3/isd_s3.py">link to the isd_s3.py code</a>.</p>
</div>
<section id="credentials">
<h3>Credentials<a class="headerlink" href="#credentials" title="Link to this heading">#</a></h3>
<p>By default, isd-s3 looks for an Access ID and Secret Key inside the <code class="docutils literal notranslate"><span class="pre">~/.aws/credentials</span></code> file. Before trying to use isd-s3 please place S3 credentials in to this file. Below is an example of what that would look like.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">myprofile</span><span class="p">]</span>
<span class="n">aws_access_key_id</span>     <span class="o">=</span> <span class="n">yourotheraccessidhere</span>
<span class="n">aws_secret_access_key</span> <span class="o">=</span> <span class="n">yourothersecretkeyhere</span>
<span class="p">[</span><span class="n">default</span><span class="p">]</span>
<span class="n">aws_access_key_id</span> <span class="o">=</span> <span class="n">youraccessidhere</span>
<span class="n">aws_secret_access_key</span> <span class="o">=</span> <span class="n">yoursecretkeyhere</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use a different file for credentials update the following environment variable : <code class="docutils literal notranslate"><span class="pre">AWS_SHARED_CREDENTIALS_FILE</span> </code>.
If you want to change the profile to use, [default] is the default, update the following environment variable : <code class="docutils literal notranslate"><span class="pre">AWS_PROFILE</span> </code>.</p>
</div>
</section>
<section id="create-a-session">
<h3>Create a Session<a class="headerlink" href="#create-a-session" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">isd_s3</span> <span class="kn">import</span> <span class="n">isd_s3</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">isd_s3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="list-all-buckets">
<h3>List all buckets<a class="headerlink" href="#list-all-buckets" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">list_buckets</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Returns a list of dictionary arrays.</p>
</section>
<section id="list-all-objects-in-a-bucket">
<h3>List all objects in a bucket<a class="headerlink" href="#list-all-objects-in-a-bucket" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">list_objects</span><span class="p">(</span><span class="s1">&#39;cisl-cloud-users&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Returns a list of dictionary arrays.</p>
</section>
<section id="upload-an-object">
<h3>Upload an Object<a class="headerlink" href="#upload-an-object" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The first value in the function is the local file path. The second value is the Objects key, or unique name/identifier, in the bucket provided</span>
<span class="n">session</span><span class="o">.</span><span class="n">upload_object</span><span class="p">(</span><span class="s1">&#39;temp_stats_1-4-24.png&#39;</span><span class="p">,</span><span class="s1">&#39;ncote/temp_stats_1-4-24.png&#39;</span><span class="p">,</span><span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;created_by&#39;</span><span class="p">:</span><span class="s1">&#39;ncote@ucar.edu&#39;</span><span class="p">},</span><span class="n">bucket</span><span class="o">=</span><span class="s1">&#39;cisl-cloud-users&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-an-object">
<h3>Download an Object<a class="headerlink" href="#download-an-object" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="s1">&#39;ncote/tmax.day.eval.NAM-44i.raw_TS.png&#39;</span><span class="p">,</span><span class="n">bucket</span><span class="o">=</span><span class="s1">&#39;cisl-cloud-users&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Returns a Key Value pair like <code class="docutils literal notranslate"><span class="pre">{'result':</span> <span class="pre">'successful'}</span></code></p>
</section>
</section>
<section id="boto3">
<h2>boto3<a class="headerlink" href="#boto3" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>Credentials<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>These functions use the Python package <code class="docutils literal notranslate"><span class="pre">os</span></code> to get your Stratus Access ID and Secret Key. Please export the following variables.</p>
<p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">AWS_ACCESS_KEY_ID=&quot;youraccessidhere&quot;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">AWS_SECRET_ACCESS_KEY=&quot;yousecretkeyhere&quot;</span></code></p>
</section>
<section id="import-required-python-modules">
<h3>Import required python modules<a class="headerlink" href="#import-required-python-modules" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># os is used to get local environment variables </span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># boto3 is the python package used to interact with S3</span>
<span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">import</span> <span class="nn">botocore</span>
<span class="c1"># This requests package is imported to disable certificate access warnings. </span>
<span class="c1"># SSL certificates can be provided and this would not be required.</span>
<span class="kn">import</span> <span class="nn">requests.packages.urllib3</span>
<span class="c1"># We aren&#39;t verifying certs to start so this line is disable warnings</span>
<span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="stratus-s3-client">
<h3>Stratus S3 Client<a class="headerlink" href="#stratus-s3-client" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the Stratus S3 client to be used in other operations</span>
<span class="k">def</span> <span class="nf">stratus_s3_client</span><span class="p">():</span>
    <span class="c1"># Define the API endpoint for stratus</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s2">&quot;https://stratus.ucar.edu/&quot;</span>
    <span class="c1"># Create a boto3 sessions</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="c1"># Get the API keys required from OS environmental variables</span>
    <span class="c1"># Set these yourself locally so keys are not exposed in plain text in code</span>
    <span class="n">access_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;AWS_ACCESS_KEY_ID&quot;</span><span class="p">)</span>
    <span class="n">secret_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;AWS_SECRET_ACCESS_KEY&quot;</span><span class="p">)</span>
    <span class="c1"># Create the S3 client based on the variables we set and provided</span>
    <span class="n">s3_client</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">client</span><span class="p">(</span>
        <span class="n">service_name</span><span class="o">=</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> 
        <span class="n">endpoint_url</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span> 
        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">access_key</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">secret_key</span><span class="p">,</span>
        <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Return the client so that it can be used in other functions</span>
    <span class="k">return</span> <span class="n">s3_client</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="stratus-s3-resource">
<h3>Stratus S3 Resource<a class="headerlink" href="#stratus-s3-resource" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the Stratus S3 resource to be used in other operations    </span>
<span class="k">def</span> <span class="nf">stratus_s3_resource</span><span class="p">():</span>
    <span class="c1"># Define the API endpoint for stratus</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s2">&quot;https://stratus.ucar.edu/&quot;</span>
    <span class="c1"># Create a boto3 sessions</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="c1"># Get the API keys required from OS environmental variables</span>
    <span class="c1"># Set these yourself locally so keys are not exposed in plain text in code</span>
    <span class="n">access_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;AWS_ACCESS_KEY_ID&quot;</span><span class="p">)</span>
    <span class="n">secret_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;AWS_SECRET_ACCESS_KEY&quot;</span><span class="p">)</span>
    <span class="c1"># Create the S3 resource based on the variables we set and provided</span>
    <span class="n">s3_resource</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span>
        <span class="n">service_name</span><span class="o">=</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> 
        <span class="n">endpoint_url</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span> 
        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">access_key</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">secret_key</span><span class="p">,</span>
        <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Return the client so that it can be used in other functions</span>
    <span class="k">return</span> <span class="n">s3_resource</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-bucket">
<h3>Create a bucket<a class="headerlink" href="#create-a-bucket" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only administrators will be able to create new buckets. If you need a new bucket created with privileges for your account please follow this <a class="reference internal" href="../create-tickets.html"><span class="doc std std-doc">link to create a ticket</span></a>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function to create a new S3 bucket with a name set by the bucket_name argument</span>
<span class="k">def</span> <span class="nf">create_bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">):</span>
    <span class="c1"># Use the S3 client already defined to make the call</span>
    <span class="n">s3_client</span> <span class="o">=</span> <span class="n">stratus_s3_client</span><span class="p">()</span>
    <span class="c1"># Call the create_bucket endpoint and provide the bucket_name specified by the user</span>
    <span class="n">s3_client</span><span class="o">.</span><span class="n">create_bucket</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>List all buckets<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function to list all buckets in the space</span>
<span class="k">def</span> <span class="nf">list_all_buckets</span><span class="p">():</span>
    <span class="c1"># Use the S3 client already defined to make the call</span>
    <span class="n">s3_client</span> <span class="o">=</span> <span class="n">stratus_s3_client</span><span class="p">()</span>
    <span class="c1"># Get a response from the list_buckets endpoint</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">s3_client</span><span class="o">.</span><span class="n">list_buckets</span><span class="p">()</span>
    <span class="c1"># Iterate through the Buckets in the response to print all the bucket names</span>
    <span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Buckets&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">bucket</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="list-all-object-in-a-bucket">
<h3>List all object in a bucket<a class="headerlink" href="#list-all-object-in-a-bucket" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function to list all the objects stored in a bucket</span>
<span class="k">def</span> <span class="nf">list_bucket_objs</span><span class="p">(</span><span class="n">bucket</span><span class="p">):</span>
    <span class="c1"># Use the S3 resource already defined to make the call</span>
    <span class="n">s3_resource</span> <span class="o">=</span> <span class="n">stratus_s3_resource</span><span class="p">()</span>
    <span class="c1"># Get the individual bucket resources for the bucket name provided in the function </span>
    <span class="n">bucket</span> <span class="o">=</span> <span class="n">s3_resource</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="n">bucket</span><span class="p">)</span>
    <span class="c1"># Iterate through the response to show all objects contained within the bucket</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">bucket</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="upload-a-file">
<h3>Upload a file<a class="headerlink" href="#upload-a-file" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please check and make sure the file being uploaded has a unique and descriptive filename that won’t conflict with any existing data.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function to upload a file/object to a bucket, specify the filename to upload and the bucket name to be placed in</span>
<span class="k">def</span> <span class="nf">upload_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">bucketname</span><span class="p">):</span>
    <span class="c1"># Use the S3 client already defined to make the call</span>
    <span class="n">s3_client</span> <span class="o">=</span> <span class="n">stratus_s3_client</span><span class="p">()</span>
    <span class="c1"># Use the upload_file endpoint to upload our filename to the specified bucket and keep the filename the same</span>
    <span class="n">s3_client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">bucketname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-a-file">
<h3>Download a file<a class="headerlink" href="#download-a-file" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function to download a file/object to a bucket</span>
<span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">bucketname</span><span class="p">):</span>
    <span class="c1"># Use the S3 client already defined to make the call</span>
    <span class="n">s3_client</span> <span class="o">=</span> <span class="n">stratus_s3_client</span><span class="p">()</span>
    <span class="c1"># Open a local file with the same filename as the one we are downloading</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">data</span><span class="p">:</span>
        <span class="c1"># Write the file to our open local file which is the python variable &#39;data&#39;</span>
        <span class="n">s3_client</span><span class="o">.</span><span class="n">download_fileobj</span><span class="p">(</span><span class="n">bucketname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./how-to/Stratus"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                  </article>

                
                

                
                
                  <footer class="prev-next-footer">
                    
<div class="prev-next-area">
</div>
                  </footer>
                
              </div>

              
              
                
                  <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#isd-s3">isd_s3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credentials">Credentials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-session">Create a Session</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#list-all-buckets">List all buckets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#list-all-objects-in-a-bucket">List all objects in a bucket</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upload-an-object">Upload an Object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-an-object">Download an Object</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boto3">boto3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Credentials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-python-modules">Import required python modules</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stratus-s3-client">Stratus S3 Client</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stratus-s3-resource">Stratus S3 Resource</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-bucket">Create a bucket</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">List all buckets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#list-all-object-in-a-bucket">List all object in a bucket</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upload-a-file">Upload a file</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-a-file">Download a file</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
                
              


                
                <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://binder.k8s.ucar.edu/v2/gh/NCAR/cisl-cloud/docs?urlpath=lab/tree/how-to/Stratus/stratus-cmd.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://jupyter.k8s.ucar.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/NCAR/cisl-cloud&urlpath=lab/tree/cisl-cloud/how-to/Stratus/stratus-cmd.ipynb&branch=docs" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/NCAR/cisl-cloud" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NCAR/cisl-cloud/issues/new?title=Issue%20on%20page%20%2Fhow-to/Stratus/stratus-cmd.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/how-to/Stratus/stratus-cmd.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
            </div>

            <footer class="bd-footer-content">
              
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The CISL Cloud Pilot Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on 13 May 2025.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
            </footer>

        </main>
    </div>
  </div>
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
     
  
  
  
  
    <div class="footer-items__start">
      <div class="container-fluid m-0 p-0">
      
        <div class="footer-item"><style>
  @import url('https://fonts.googleapis.com/css?family=Poppins:400,600,700');
</style>
<div class="grid-x grid-padding-y footer-menu-tertiary">
  <div class="cell text-center custom-footer">
      <small>©  UCAR</small>
          <a href="https://www.ucar.edu/privacy-notice" class="custom-footer-link">Privacy</a>
          <a href="https://www.ucar.edu/cookie-other-tracking-technologies-notice" class="custom-footer-link">Cookies</a>
          <a href="https://www.ucar.edu/terms-of-use" class="custom-footer-link">Terms of Use</a>
          <a href="https://www.ucar.edu/notification-copyright-infringement-digital-millenium-copyright-act" class="custom-footer-link">Copyright Issues</a>
          <a href="https://nsf.gov" class="custom-footer-link">Sponsored by NSF</a>
          <a href="https://ncar.ucar.edu" class="custom-footer-link">NCAR Home</a>
          <a href="https://www.ucar.edu" class="custom-footer-link">UCAR Home</a>
      </ul>
  </div>
</div></div>
      
        <div class="footer-item">  <div class="container-fluid footer-info">
    <div class="container-xl">
      <div class="d-flex justify-content-center">
        <p class="py-1 m-0">
            &copy;&nbsp;2023.
        
          By The CISL Cloud Pilot Team.
        
          Last updated on 13 May 2025.
        </p>
      </div>
    </div>
  </div></div>
      
        <div class="footer-item"><div class="container-fluid footer-extra">
    <div class="container">
      <center>
        Theme by <a href="https://projectpythia.org">Project Pythia</a>. All code
        in Pythia Foundations is licensed under Apache 2.0. All other non-code
        content is licensed under
        <a href="https://creativecommons.org/licenses/by/4.0/">
          Creative Commons BY 4.0 (CC BY 4.0)</a
        >.
      </center>
      <br />
      <div class="row">
        <p class="m-0">
          <img
            src="../../_static/footer-logo-nsf.png"
            style="float: left; width: 60px; height: 60px; margin-right: 1rem"
          />
          This material is based upon work supported by the NSF National Center  for Atmospheric Research, a major facility sponsored by the U.S. National Science Foundation and managed by the University  Corporation for Atmospheric Research. Any opinions, findings and  conclusions or recommendations expressed in this material do not  necessarily reflect the views of the U.S. National Science Foundation. 
        </p>
      </div>
    </div>
  </div></div>
      
      </div>
    </div>
  

  </footer>
  </body>
</html>